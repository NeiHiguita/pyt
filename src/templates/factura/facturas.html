{% extends "components/layout.html" %}

{% block title %}Facturas{% endblock %}

{% block content %}
<style>
    .table-container {
        margin-top: 10px;
        padding: 10px;
        border-radius: 12px;
        background: #f9f9f9;
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
        max-height: 370px;
        /* Altura máxima antes de activar el scroll */
        overflow-y: auto;
        /* Scroll vertical */
        border: 1px solid #ccc;
        border-radius: 8px;
        position: relative;
    }

    /* Estilo del scrollbar */
    .table-container::-webkit-scrollbar {
        width: 8px;
        /* Ancho del scrollbar */
    }

    .table-container::-webkit-scrollbar-thumb {
        background-color: #1D3A6C;
        /* Color del scrollbar */
        border-radius: 4px;
        /* Bordes redondeados */
    }

    .table-container::-webkit-scrollbar-thumb:hover {
        background-color: #0F264A;
        /* Color más oscuro al pasar el mouse */
    }

    .table-container::-webkit-scrollbar-track {
        background: #f1f1f1;
        /* Color de fondo del scrollbar */
        border-radius: 4px;
    }

    /* Estilos de la tabla */
    .table {
        width: 100%;
        border-collapse: collapse;
    }

    .table thead {
        position: sticky;
        top: -11px;
        background-color: #1D3A6C;
        /* Mantiene el color de fondo al hacer scroll */
        z-index: 100;
    }

    .table th,
    .table td {
        padding: 5px 20px;
        /* reduce el espacio interno */
        font-size: 14px;
        border-bottom: 1px solid #ddd;
        /*centrar a la mitad del espacio*/
        vertical-align: middle;
        text-align: center;
    }


    .table th {
        background-color: #1D3A6C;
        color: white;
        padding: 10px;
        text-align: center;
    }

    .table tr:hover {
        background-color: #f1f1f1;
    }

    .title {
        text-align: center;
        font-size: 24px;
        /* Tamaño más grande */
        font-weight: bold;
        /* Negrita para destacar */
        color: #1D3A6C;
        /* Color que usas en otros elementos */
        margin-bottom: 20px;
        /* Espacio debajo */
        text-transform: uppercase;
        /* Mayúsculas para resaltar */
        letter-spacing: 1px;
        /* Espaciado entre letras */
    }

    .container {
        max-width: 1100px;
        margin: auto;
        text-align: center;
        background-color: #f9f9f9;
        padding: 30px;
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.4);
        border-radius: 12px;
        margin-top: 30px;
    }

    .btns {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-right: 590px;
    }
    .table-actions {
    text-align: center;
}

.action-buttons {
    display: flex;
    justify-content: center;
    gap: 16px; /* Espacio entre botones */
}

.action-buttons a {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 8px;
    border-radius: 6px;
    text-decoration: none;
    transition: background-color 0.3s ease;
}

/* Botón de advertencia (editar) */
.btn-warning {
    background-color: #f3991a;
}

/* Botón de éxito (enviado) */
.btn-success {
    background-color: #44d244;
}

/* Botón de peligro (no enviado) */
.btn-danger {
    background-color: #dc3731;
}
.disabled-link {
    pointer-events: none;  /* evita que se haga clic */
    opacity: 0.5;          /* apariencia desactivada */
    cursor: not-allowed;   /* cursor de "no permitido" */
}

/* Iconos SVG dentro de los botones */
.action-buttons svg {
    display: block;
}

</style>
<div class="container">

    <h1 class="title" style="display: flex;justify-content: center;">Facturas Registradas
        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1D3A6C">
            <path
                d="M240-80q-50 0-85-35t-35-85v-120h120v-560l60 60 60-60 60 60 60-60 60 60 60-60 60 60 60-60 60 60 60-60v680q0 50-35 85t-85 35H240Zm480-80q17 0 28.5-11.5T760-200v-560H320v440h360v120q0 17 11.5 28.5T720-160ZM360-600v-80h240v80H360Zm0 120v-80h240v80H360Zm320-120q-17 0-28.5-11.5T640-640q0-17 11.5-28.5T680-680q17 0 28.5 11.5T720-640q0 17-11.5 28.5T680-600Zm0 120q-17 0-28.5-11.5T640-520q0-17 11.5-28.5T680-560q17 0 28.5 11.5T720-520q0 17-11.5 28.5T680-480ZM240-160h360v-80H200v40q0 17 11.5 28.5T240-160Zm-40 0v-80 80Z" />
        </svg>
    </h1>
    <div class="btns">
        <a class="btn btn-primary" href="/api/facturas/nueva">
            <span class="icon"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960"
                    width="24px" fill="#fff">
                    <path d="M440-440H200v-80h240v-240h80v240h240v80H520v240h-80v-240Z" />
                </svg></span> Registrar Factura
        </a>
        <a class="btn btn-primary">
            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#fff">
                <path
                    d="M160-160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h240l80 80h320q33 0 56.5 23.5T880-640v242q-18-14-38-23t-42-19v-200H447l-80-80H160v480h120v80H160ZM640-40q-91 0-168-48T360-220q35-84 112-132t168-48q91 0 168 48t112 132q-35 84-112 132T640-40Zm0-80q57 0 107.5-26t82.5-74q-32-48-82.5-74T640-320q-57 0-107.5 26T450-220q32 48 82.5 74T640-120Zm0-40q-25 0-42.5-17.5T580-220q0-25 17.5-42.5T640-280q25 0 42.5 17.5T700-220q0 25-17.5 42.5T640-160Zm-480-80v-480 277-37 240Z" />
            </svg> Ver Total de facturas Diarias
        </a>
    </div>
    <div class="table-container">
        <table class="table">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Fecha</th>
                    <th>Tipo de Proceso</th>
                    <th>Subtotal</th>
                    <th>Descripción</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                {% for factura in facturas %}
                <tr>
                    <td>{{ factura.id }}</td>
                    <td>{{ factura.fecha.strftime('%d/%m/%Y') }}</td>
                    <td>{{ factura.tipo_proceso }}</td>
                    <td>${{ "{:,.0f}".format(factura.subtotal) }}</td>
                    <td>{{ factura.descripcion }}</td>
                    <td class="table-actions">
                        <div class="action-buttons">
                            <a href="/api/facturas/{{ factura.id }}/editar" class="btn btn-warning">
                                <!-- Icono Editar -->
                                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960"
                                    width="24px" fill="#e3e3e3">
                                    <path
                                        d="M200-200h57l391-391-57-57-391 391v57Zm-80 80v-170l528-527q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L290-120H120Zm640-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z" />
                                </svg>
                            </a>
                    
                            {% if factura.estado == 1 %}
                            <a href="" class="btn btn-success">
                                <!-- Icono Enviado -->
                                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960"
                                    width="24px" fill="#fff">
                                    <path
                                        d="M280-240q-100 0-170-70T40-480q0-100 70-170t170-70h400q100 0 170 70t70 170q0 100-70 170t-170 70H280Zm0-80h400q66 0 113-47t47-113q0-66-47-113t-113-47H280q-66 0-113 47t-47 113q0 66 47 113t113 47Zm400-40q50 0 85-35t35-85q0-50-35-85t-85-35q-50 0-85 35t-35 85q0 50 35 85t85 35ZM480-480Z" />
                                </svg>
                            </a>
                            {% else %}
                            <a class="btn btn-danger disabled-link">
                                <!-- Icono No Enviado -->
                                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960"
                                    width="24px" fill="#fff">
                                    <path
                                        d="M280-240q-100 0-170-70T40-480q0-100 70-170t170-70h400q100 0 170 70t70 170q0 100-70 170t-170 70H280Zm0-80h400q66 0 113-47t47-113q0-66-47-113t-113-47H280q-66 0-113 47t-47 113q0 66 47 113t113 47Zm0-40q50 0 85-35t35-85q0-50-35-85t-85-35q-50 0-85 35t-35 85q0 50 35 85t85 35Zm200-120Z" />
                                </svg>
                            </a>
                            {% endif %}
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}